<!DOCTYPE html>
<html>
<head>
<title>Shree Laxmi Laboratory</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;
font-family:Arial;
background:#f4f6f9;
}

/* SIDEBAR */
.sidebar{
position:fixed;
width:230px;
height:100%;
background:#1f2d3d;
color:white;
padding-top:20px;
}

.sidebar h2{
text-align:center;
margin-bottom:30px;
}

.sidebar a{
display:block;
color:white;
padding:12px 20px;
text-decoration:none;
}

.sidebar a:hover{
background:#32475b;
}

/* MAIN */
.main{
margin-left:230px;
padding:20px;
}

/* TOP BAR */
.topbar{
background:white;
padding:15px;
border-radius:8px;
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:20px;
}

.badge{
background:linear-gradient(45deg,#4e73df,#1cc88a);
color:white;
padding:8px 15px;
border-radius:20px;
font-weight:bold;
}

/* TABS */
.tabs{
display:flex;
gap:15px;
margin-bottom:15px;
}

.tab{
padding:10px 15px;
background:#e2e6ea;
border-radius:6px;
cursor:pointer;
}

.tab.active{
background:#4e73df;
color:white;
}

/* FILTER BUTTONS */
.filters{
margin-bottom:15px;
}

.filters button{
padding:6px 12px;
border:none;
border-radius:5px;
margin-right:5px;
cursor:pointer;
}

tr.collected { background:#d1ecf1; }
tr.acknowledged { background:#cce5ff; }
tr.processed { background:#d4edda; }
tr.printed { background:#d1f2eb; }
tr.psn { background:#f8d7da; }

/* TABLE */
table{
width:100%;
background:white;
border-radius:8px;
overflow:hidden;
border-collapse:collapse;
}

th{
background:#2e59d9;
color:white;
padding:10px;
}

td{
padding:8px;
text-align:center;
border-bottom:1px solid #ddd;
}

tr.green{
background:#d4edda;
}

.view-btn{
background:#6f42c1;
color:white;
border:none;
padding:5px 10px;
border-radius:5px;
cursor:pointer;
}

.icon-btn{
background:#4e73df;
color:white;
border:none;
padding:5px 8px;
border-radius:5px;
cursor:pointer;
margin:2px;
}
</style>
</head>

<body>

<div class="sidebar">
<h2>Shree Laxmi</h2>
<a href="#">Dashboard</a>
<a href="#">Bookings</a>
<a href="#">Ledger</a>
<a href="#">Inventory</a>
<a href="#">Billing</a>
<a href="#">Report Status</a>
<a href="#">Logout</a>
</div>

<div class="main">

<div class="topbar">
<div class="badge">YOUR BADGE IS BRONZE</div>
<button class="icon-btn" onclick="openModal()">+ New Booking</button>
</div>

<div class="tabs">
<div class="tab active">My Bookings</div>
<div class="tab">Follow Up</div>
<div class="tab">Online Leads</div>
<div class="tab">Online Bookings</div>
</div>

<div class="filters">
<button onclick="filterStatus('all')">All</button>
<button class="collected" onclick="filterStatus('Collected')">Collected</button>
<button class="ack" onclick="filterStatus('Acknowledged')">Acknowledged</button>
<button class="processed" onclick="filterStatus('Processed')">Processed</button>
<button class="printed" onclick="filterStatus('Printed')">Printed</button>
<button class="psn" onclick="filterStatus('PSN')">PSN/SNR</button>
</div>

  <div id="bookingModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">

  <div style="background:white; width:400px; margin:80px auto; padding:20px; border-radius:8px;">

    <div id="step1">
      <h3>Enter Mobile Number</h3>
      <input type="text" id="mobileStep" placeholder="Mobile Number" style="width:100%; padding:8px;">
      <br><br>
      <button onclick="nextStep(2)">Next</button>
    </div>

    <div id="step2" style="display:none;">
      <h3>Patient Details</h3>
      <input type="text" id="patientName" placeholder="Patient Name" style="width:100%; padding:8px;"><br><br>
      <input type="number" id="age" placeholder="Age" style="width:100%; padding:8px;"><br><br>
      <select id="gender" style="width:100%; padding:8px;">
        <option>Male</option>
        <option>Female</option>
      </select>
      <br><br>
      <button onclick="nextStep(3)">Next</button>
    </div>

    <div id="step3" style="display:none;">
      <h3>Test & Payment</h3>
      <input type="text" id="testName" placeholder="Test Name" style="width:100%; padding:8px;"><br><br>
      <input type="number" id="amount" placeholder="Amount" style="width:100%; padding:8px;"><br><br>
      <button onclick="submitBooking()">Submit Booking</button>
    </div>

    <br>
    <button onclick="closeModal()">Cancel</button>

  </div>
</div>
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Mobile</th>
<th>Report Time</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody id="bookingTable"></tbody>
</table>

</div>

<script>

let allBookings = [];

function loadFromSheet(){
fetch("https://script.google.com/macros/s/AKfycbwOj6IBtK6Mb_Z6E8apfSk13JfTawQOyDua3o7K8xzn2ixDmxf4h53OYWoFPtavSwR6/exec")
.then(res=>res.json())
.then(data=>{
allBookings=data;
loadTable(allBookings);
})
.catch(err=>console.log("Error:",err));
}

loadFromSheet();
  function openModal() {
   document.getElementById("bookingModal").style.display = "block";
   document.getElementById("step1").style.display = "block";
   document.getElementById("step2").style.display = "none";
   document.getElementById("step3").style.display = "none";
}

function closeModal() {
   document.getElementById("bookingModal").style.display = "none";
}

function nextStep(step) {
   document.getElementById("step1").style.display = "none";
   document.getElementById("step2").style.display = "none";
   document.getElementById("step3").style.display = "none";

   document.getElementById("step" + step).style.display = "block";
}
function submitBooking() {
   const booking = {
      id: Date.now(),
      name: document.getElementById("patientName").value,
      mobile: document.getElementById("mobileStep").value,
      time: new Date().toLocaleString(),
      status: "Collected"
   };

   fetch("https://script.google.com/macros/s/AKfycbwOj6IBtK6Mb_Z6E8apfSk13JfTawQOyDua3o7K8xzn2ixDmxf4h53OYWoFPtavSwR6/exec", {
      method: "POST",
      body: JSON.stringify(booking)
   })
   .then(res => res.json())
   .then(data => {
      alert("Booking Added Successfully");
      closeModal();
      loadFromSheet();
   });
}
function loadTable(data){
const table=document.getElementById("bookingTable");
table.innerHTML="";

data.forEach(b=>{
table.innerHTML+=`
<tr class="${b.Status.toLowerCase()}">
<td>${b.ID}</td>
<td>${b.Name}</td>
<td>${b.Mobile}</td>
<td>${b.Time}</td>
<td>${b.Status}</td>
<td>
<button onclick="updateStatus('${b.ID}','Processed')">Processed</button>
<button onclick="updateStatus('${b.ID}','Printed')">Printed</button>
</td>
</tr>
`;
});
}

function filterStatus(status){
if(status=="all"){
loadTable(allBookings);
}else{
loadTable(allBookings.filter(b=>b.Status==status));
}
}

loadTable(allBookings);

</script>

</body>
</html>
